!function(t,i){String.prototype.startsWith||function(){"use strict";var t=function(){try{var t={},i=Object.defineProperty,s=i(t,t,t)&&i}catch(t){}return s}(),i={}.toString,s=function(t){if(null==this)throw TypeError();var s=String(this);if(t&&"[object RegExp]"==i.call(t))throw TypeError();var e=s.length,r=String(t),n=r.length,o=arguments.length>1?arguments[1]:void 0,a=o?Number(o):0;a!=a&&(a=0);var h=Math.min(Math.max(a,0),e);if(n+h>e)return!1;for(var l=-1;++l<n;)if(s.charCodeAt(h+l)!=r.charCodeAt(l))return!1;return!0};t?t(String.prototype,"startsWith",{value:s,configurable:!0,writable:!0}):String.prototype.startsWith=s}(),String.prototype.endsWith||function(){"use strict";var t=function(){try{var t={},i=Object.defineProperty,s=i(t,t,t)&&i}catch(t){}return s}(),i={}.toString,s=function(t){if(null==this)throw TypeError();var s=String(this);if(t&&"[object RegExp]"==i.call(t))throw TypeError();var e=s.length,r=String(t),n=r.length,o=e;if(arguments.length>1){var a=arguments[1];void 0!==a&&(o=a?Number(a):0)!=o&&(o=0)}var h=Math.min(Math.max(o,0),e),l=h-n;if(l<0)return!1;for(var p=-1;++p<n;)if(s.charCodeAt(l+p)!=r.charCodeAt(p))return!1;return!0};t?t(String.prototype,"endsWith",{value:s,configurable:!0,writable:!0}):String.prototype.endsWith=s}(),"object"==typeof module&&module.exports?module.exports=i(require("d3")):"function"==typeof define&&define.amd?define(["d3"],i):t.SimpleGraph=i(t.d3)}(this,function(t){function i(i){return i||(i={}),i.container||(i.container="body"),i.margins||(i.margins={}),i.axis||(i.axis={}),this.allowDrawBeyondGraph=i.allowDrawBeyondGraph,this.margins={left:i.margins.left||0===i.margins.left?i.margins.left:40,right:i.margins.right||0===i.margins.right?i.margins.right:20,top:i.margins.top||0===i.margins.top?i.margins.top:20,bottom:i.margins.bottom||0===i.margins.bottom?i.margins.bottom:40},this.containerWidth=i.width?i.width:600,this.containerHeight=i.height?i.height:400,this.width=this.containerWidth-this.margins.left-this.margins.right,this.height=this.containerHeight-this.margins.top-this.margins.bottom,this.color=i.colorScale?i.colorScale:t.scaleOrdinal(t.schemeCategory10),this.customColors={},this.svg=t.select(i.container).append("svg").attr("width",this.containerWidth).attr("height",this.containerHeight).style("font-family","'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif").style("font-size","14px").style("overflow","visible"),this.svgGraph=this.svg.append("g").attr("transform","translate("+this.margins.left+","+this.margins.top+")"),this.resetAxisOptions(i.axis),this}return i.prototype.resetAxisOptions=function(i){i||(i={}),i.x||(i.x={}),i.y||(i.y={}),i.styles||(i.styles={}),this.axisStyles=i.style,this.axisStyles||(this.axisStyles={}),this.axisStyles.fill||(this.axisStyles.fill="none"),this.axisStyles["stroke-width"]||(this.axisStyles["stroke-width"]=.5),this.axisStyles.stroke||(this.axisStyles.stroke="black");for(var s=["x","y","y2"],e=0;e<s.length;e++){var r=s[e];if(!i[r]){if("y2"===r)continue;i[r]={}}i[r].scale||(i[r].scale=t.scaleLinear);var n=i[r].scale===t.scaleTime||i[r].scale===t.scaleUtc,o=!n&&i[r].scale===t.scaleLog;i[r].format||(i[r].format=n?"%Y-%m-%d":".0f"),i[r].grid||(i[r].grid={}),o&&!i[r].logBase&&(i[r].logBase=10),this[r]={label:null===i[r].label?"x"===r?"x-value":"y-value":i[r].label,isDate:n,isLog:o},n?i[r].scale===t.scaleUtc?this[r].format=t.utcFormat(i[r].format):this[r].format=t.timeFormat(i[r].format):this[r].format=t.format(i[r].format),this[r].min=i[r].min?i[r].min:0,this[r].max=i[r].max?i[r].max:100,this[r].scale=i[r].scale(),o&&this[r].scale.base(i[r].logBase),this[r].scale.domain([this[r].min,this[r].max]).range("x"===r?[0,this.width]:[this.height,0]);var a=!1;"x"===r?(a=!0,this[r].axis=t.axisBottom(this[r].scale),this[r].axisTwo=t.axisTop(this[r].scale),this[r].gridAxis=t.axisBottom(this[r].scale)):"y2"===r?(this[r].axis=t.axisRight(this[r].scale),this[r].gridAxis=t.axisRight(this[r].scale)):(this[r].axis=t.axisLeft(this[r].scale),this[r].gridAxis=t.axisLeft(this[r].scale)),o?(this[r].axis.tickFormat(this[r].format),i[r].ticks?this[r].axis.ticks(i[r].ticks,this[r].format):(this[r].axis.ticks(this[r].format),i[r].tickValues&&this[r].axis.tickValues(i[r].tickValues)),a&&(this[r].axisTwo.tickFormat(this[r].format),i[r].ticks?this[r].axisTwo.ticks(i[r].ticks,this[r].format):(this[r].axisTwo.ticks(this[r].format),i[r].tickValues&&this[r].axisTwo.tickValues(i[r].tickValues)))):(this[r].axis.tickFormat(this[r].format),i[r].tickValues?(this[r].axis.tickValues(i[r].tickValues),this[r].gridAxis.tickValues(i[r].tickValues)):(i[r].ticks||0===i[r].ticks)&&(Array.isArray(i[r].ticks)?(this[r].axis.ticks(i[r].ticks[0],i[r].ticks[1]),this[r].gridAxis.ticks(i[r].ticks[0],i[r].ticks[1])):(this[r].axis.ticks(i[r].ticks),this[r].gridAxis.ticks(i[r].ticks))),this[r].gridAxis.tickFormat(this[r].format),i[r].grid.tickValues?this[r].gridAxis.tickValues(i[r].grid.tickValues):(i[r].grid.ticks||0===i[r].grid.ticks)&&(Array.isArray(i[r].grid.ticks)?this[r].gridAxis.ticks(i[r].grid.ticks[0],i[r].grid.ticks[1]):this[r].gridAxis.ticks(i[r].grid.ticks)),a&&(this[r].axisTwo.tickFormat(this[r].format),i[r].tickValues?this[r].axisTwo.tickValues(i[r].tickValues):(i[r].ticks||0===i[r].ticks)&&(Array.isArray(i[r].ticks)?this[r].axisTwo.ticks(i[r].ticks[0],i[r].ticks[1]):this[r].axisTwo.ticks(i[r].ticks))))}return this.minMax={x:[this.x.min,this.x.max],y:[this.y.min,this.y.max]},this.xScale=this.x.scale,this.xAxis=this.x.axis,this.xGridAxis=this.x.gridAxes,this.yScale=this.y.scale,this.yAxis=this.y.axis,this.yGridAxis=this.y.gridAxes,this.removeAll(),this.drawAxes(),this},i.prototype.getSvgElement=function(){return this.svg},i.prototype.getSvgGraphic=function(){return this.svgGraph},i.prototype.remove=function(){return this.svg.remove(),this},i.prototype.destroy=function(){this.svg.remove(),this.svg=null,this.svgGraph=null,this.clearAllData(),this.color=null,this.customColors=null,this.x=null,this.y=null,this.minMax=null,this.xScale=null,this.yScale=null,this.yAxis=null,this.xAxis=null,this.yGridAxis=null,this.xGridAxis=null},i.prototype.drawAxes=function(t,i,s){i?"top"!==(i=i.toLowerCase().trim())&&(i="bottom"):i="bottom";var e,r=0;"top"!==i?(e=this.x.axis,r=this.height):e=this.x.axisTwo,s||(s=0),this.svg.selectAll(".sg-xaxis, .sg-yaxis, .sg-y2axis, .sg-axis-label").remove();var n=this.svgGraph.append("g").attr("class","sg-xaxis").attr("transform","translate(0,"+r+")").style("font-size",14).style("font-family","'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif").call(e),o=this.svgGraph.append("g").attr("class","sg-yaxis").style("font-size",14).style("font-family","'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif").call(this.y.axis),a=this.y2?this.svgGraph.append("g").attr("class","sg-y2axis").attr("transform","translate("+this.width+",0)").style("font-size",14).style("font-family","'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif").call(this.y2.axis):null;this.svgGraph.selectAll(".tick line").style("stroke","#000");var h=this.svgGraph.selectAll(".sg-xaxis .domain, .sg-yaxis .domain, .sg-y2axis .domain");for(var l in this.axisStyles)h.style(l,this.axisStyles[l]);var p={x:0,y:0,y2:0};this.svgGraph.selectAll(".sg-xaxis .tick").each(function(){this.getBBox().height>p.x&&(p.x=this.getBBox().height)}),this.svgGraph.selectAll(".sg-yaxis .tick").each(function(){this.getBBox().width>p.y&&(p.y=this.getBBox().width)}),this.svgGraph.selectAll(".sg-y2axis .tick").each(function(){this.getBBox().width>p.y2&&(p.y2=this.getBBox().width)});var g={a:"middle",x:.5*this.width,y:"top"===i?-(p.x+s):p.x+10+s},c={a:"middle",x:-.5*this.height,y:-(p.y+10+s)},y={a:"middle",x:.5*this.height,y:-(p.y2+10+s)};if(t){for(var u=t.toLowerCase().split(/[ ,]+/),f="center",d="center",x="outside",m=0;m<u.length;m++)"outside"===u[m]?(g.y="top"===i?-(p.x+s):p.x+10+s,c.y=-(p.y+10+s),y.y=-(p.y2+10+s),x="outside"):"inside"===u[m]?(g.y="top"===i?14+s:-(6+s),c.y=6+s,y.y=c.y,x="inside"):"center"===u[m]?(g.a="middle",g.x=.5*this.width,c.a="middle",c.x=-.5*this.height,y.a="middle",y.x=-c.x,f="center",d="center"):"left"===u[m]?(g.a="start",g.x=0,f="left"):"right"===u[m]?(g.a="end",g.x=this.width,f="right"):"top"===u[m]?(c.a="end",c.x=0,y.a="start",y.x=-c.x,d="top"):"bottom"===u[m]&&(c.a="start",c.x=-this.height,y.a="end",y.x=-c.x,d="bottom");"inside"===x&&("left"===f?g.x+=10:"right"===f&&this.y2&&(g.x-=10),"bottom"===i?"bottom"===d?(c.x+=10,y.x-=10,"left"===f?(g.x+=10,c.x+=10):"right"===f&&this.y2&&(g.x-=10,y.x-=10)):(c.x-=10,y.x+=10):"top"===d?(c.x-=10,y.x+=10,"left"===f?(g.x+=10,c.x-=10):"right"===f&&this.y2&&(g.x-=10,y.x+=10)):(c.x+=10,y.x-=10))}return n.append("text").attr("class","sg-axis-label sg-xaxis").attr("x",g.x).attr("y",g.y).attr("fill","#000").style("text-anchor",g.a).style("font-weight","bolder").text(this.x.label),o.append("text").attr("class","sg-axis-label sg-yaxis").attr("transform","rotate(-90)").attr("x",c.x).attr("y",c.y).attr("dy",".71em").attr("fill","#000").style("text-anchor",c.a).style("font-weight","bolder").text(this.y.label),a&&a.append("text").attr("class","sg-axis-label sg-y2axis").attr("transform","rotate(90)").attr("x",y.x).attr("y",y.y).attr("dy",".71em").attr("fill","#000").style("text-anchor",y.a).style("font-weight","bolder").text(this.y2.label),this},i.prototype.drawGrid=function(t){this.svgGraph.selectAll(".sg-grid").remove();var i=t&&t.opacity?parseFloat(t.opacity):.4,s=t&&t.stroke?t.stroke:"#555",e=t&&t["stroke-width"]?parseFloat(t["stroke-width"]):.3;return this.svgGraph.append("g").attr("class","sg-grid").attr("transform","translate(0,"+this.height+")").style("opacity",i).style("stroke",s).style("stroke-width",e).call(this.x.gridAxis.tickSize(-this.height).tickFormat("")),this.svgGraph.append("g").attr("class","sg-grid").attr("opacity",i).style("stroke",s).style("stroke-width",e).call(this.y.gridAxis.tickSize(-this.width).tickFormat("")),this},i.prototype.removeGrid=function(){return this.svgGraph.selectAll(".sg-grid").remove(),this},i.prototype.drawLegend=function(t,i,s,e,r,n){function o(){y++,e>0&&y>=e?(c++,y=0,u=s["padding-top"],f=l.node().getBBox().width+12):u+=r}this.svg.selectAll(".sg-legend").remove(),t?t.x&&t.y||(t.x||0===t.x||(t.x=void 0!==t[0]&&"number"==typeof t[0]?t[0]:this.width+5),t.y||0===t.y||(t.y=void 0!==t[1]&&"number"==typeof t[1]?t[1]:0)):t={x:0,y:0},i||(i="left"),n||(n=[]),"string"==typeof n&&(n=n.trim().split(/\s+/));for(var a=0;a<n.length;a++)n[a]=n[a].toLowerCase();if(s||(s={}),s.padding){var h="string"==typeof s.padding?s.padding.split(" "):[s.padding];1===h.length?(s["padding-left"]=h[0],s["padding-right"]=h[0],s["padding-top"]=h[0],s["padding-bottom"]=h[0]):2===h.length?(s["padding-left"]=h[1],s["padding-right"]=h[1],s["padding-top"]=h[0],s["padding-bottom"]=h[0]):(h.length>3&&(s["padding-left"]=h[3]),s["padding-right"]=h[1],s["padding-top"]=h[0],s["padding-bottom"]=h[2]),delete s.padding}else s["padding-left"]||(s["padding-left"]=0),s["padding-right"]||(s["padding-right"]=0),s["padding-top"]||(s["padding-top"]=0),s["padding-bottom"]||(s["padding-bottom"]=0);s.fill||(s.fill="#fff",s.opacity=0),s["padding-left"]=parseInt(s["padding-left"]),s["padding-right"]=parseInt(s["padding-right"]),s["padding-top"]=parseInt(s["padding-top"]),s["padding-bottom"]=parseInt(s["padding-bottom"]);var l=this.svg.append("g").attr("class","sg-legend").attr("transform","translate("+t.x+","+t.y+")"),p=l.append("rect").attr("class","sg-legend-bg").attr("x",0).attr("y",0);for(var g in s)g.startsWith("padding")||p.style(g,s[g]);e||(e=0),r||(r=24);var c=0,y=0,u=s["padding-top"],f=s["padding-left"],d=this;if(this.areas&&n.indexOf("areas")<0)for(var x=[],a=0;a<this.areas.length;a++){var m=this.areas[a].series;x.indexOf(m)<0&&(x.push(m),function(t){var i=l.append("rect").attr("x",f).attr("y",u).attr("width",18).attr("height",18);for(var s in t.style)i.style(s,t.style[s]);"fill"in t.style||i.style("fill",d.getColorBySeriesName(t.series)),l.append("text").attr("x",f+23).attr("y",u+9).attr("dy",".35em").style("text-anchor","start").text(t.series),o()}(this.areas[a]))}if(this.lines&&n.indexOf("lines")<0)for(var v=[],a=0;a<this.lines.length;a++){var m=this.lines[a].series;v.indexOf(m)<0&&(v.push(m),function(t){var i=u+10,s=l.append("path").attr("x",f).attr("y",u).attr("d","M"+f+" "+i+" L"+(18+f)+" "+i);for(var e in t.style)s.style(e,t.style[e]);"stroke"in t.style||s.style("stroke",d.getColorBySeriesName(t.series)),l.append("text").attr("x",f+23).attr("y",u+9).attr("dy",".35em").style("text-anchor","start").text(t.series),o()}(this.lines[a]))}if(this.points&&n.indexOf("points")<0)for(var w=[],a=0;a<this.points.length;a++){var m=this.points[a].series;if(w.indexOf(m)<0){w.push(m);var k=!1;if(this.pointLines)for(var A=this.pointLines.length;A--;)if(this.pointLines[A].series===m){k=!0;break}!function(t,i){if(i){var s=u+10,e=l.append("path").attr("x",f).attr("y",u).attr("d","M"+f+" "+s+" L"+(18+f)+" "+s);for(var r in d.pointLines[0].style)e.style(r,d.pointLines[0].style[r]);e.style("stroke",d.getColorBySeriesName(t.series))}var n="function"==typeof t.pointsize?t.pointsize():t.pointsize;n>14&&(n=14);var a=n/2,h=7-a,p=f+2+h,g=u+3+h;l.append("rect").attr("x",p).attr("y",g).attr("width",n).attr("height",n).attr("transform","rotate(45,"+(p+a)+","+(g+a)+")").style("fill",d.getColorBySeriesName(t.series)),l.append("text").attr("x",f+23).attr("y",u+9).attr("dy",".35em").style("text-anchor","start").text(t.series),o()}(this.points[a],k)}}var b=l.node().getBBox();return p.attr("width",b.width+s["padding-left"]+s["padding-right"]).attr("height",b.height+s["padding-top"]+s["padding-bottom"]),i=i.trim().toLowerCase(),"middle"===i?t.x-=.5*b.width:"right"===i&&(t.x-=b.width),l.attr("transform","translate("+t.x+","+t.y+")"),this},i.prototype.getColorBySeriesName=function(t,i){if(!t)return null;if(t in this.customColors)return this.customColors[t];if(this.points)for(var s in this.points){var e=this.points[s];if(t===e.series)return e.style&&e.style.fill?e.style.fill:i?this.color(t):this.color.domain().indexOf(t)>=0?this.color(t):null}if(this.lines)for(var r in this.lines){var n=this.lines[r];if(t===n.series)return n.style&&n.style.stroke?n.style.stroke:i?this.color(t):this.color.domain().indexOf(t)>=0?this.color(t):null}if(this.areas)for(var o in this.areas){var a=this.areas[o];if(t===a.series)return a.style&&a.style.fill?a.style.fill:i?this.color(t):this.color.domain().indexOf(t)>=0?this.color(t):null}return i?this.color(t):void 0},i.prototype.resetColorScale=function(t){return t?this.color=t:this.color.domain([]),this},i.prototype.setSeriesColor=function(t,i){this.customColors[t]=i},i.prototype.removeSeriesColor=function(t){return this.customColors[t]&&delete this.customColors[t],this},i.prototype.addPointData=function(t,i,s,e,r,n){this.points||(this.points=[]),(!e||e<=0)&&(e=10);var o={series:t,x:parseFloat(i),y:parseFloat(s),y2:!!r,pointsize:e};if(isNaN(o.y)||!o.y&&0!==o.y){if(!n)return this;o.y=0,o.wasNull=!0}return this.points.push(o),this},i.prototype.addPointsData=function(t,i,s,e,r,n,o,a){if(!t||0===t.length)return this;this.points||(this.points=[]),(!n||n<=0)&&(n=10);for(var h=0;h<t.length;h++){var l=i?t[h][i]?t[h][i]:i:h,p=t[h][s],g=t[h][e];if(void 0!==p&&null!==p){var c={series:l,x:p,y:parseFloat(g),y2:!!o,pointsize:n};if(isNaN(c.y)||!c.y&&0!==c.y){if(!a)continue;c.y=0,c.wasNull=!0}if(isNaN(c.y)&&(c.y=0,c.wasNull=!0),r&&Array.isArray(r))for(var y=0;y<r.length;y++){for(var u=r[y],f=u,d=2;f in c;)f=u+String(d),d++;c[f]=t[h][u]}this.points.push(c)}}return this},i.prototype.addPointsDataAsArray=function(t,i,s,e,r){if(!i||0===i.length)return this;(!s||"number"!=typeof s&&"function"!=typeof s)&&(s=10),this.points||(this.points=[]);for(var n=0;n<i.length;n++)if(void 0!==i[n][0]&&null!==i[n][0]&&void 0!==i[n][1]&&null!==i[n][1]){var o={series:t,x:parseFloat(i[n][0]),y:parseFloat(i[n][1]),y2:!!e,pointsize:s};if(isNaN(o.y)||!o.y&&0!==o.y){if(!r)continue;o.y=0,o.wasNull=!0}this.points.push(o)}return this},i.prototype.addLineDataAsCoordinates=function(i,s,e,r,n){return s&&0!==s.length?(this.lines||(this.lines=[]),e||(e={}),e["stroke-width"]&&"number"==typeof e["stroke-width"]||(e["stroke-width"]=1.5),r||(r=t.curveLinear),this.lines.push({series:i,lineFunction:null,coords:s,y2:!!n,style:e,interpolate:r}),this):this},i.prototype.addLineDataAsFunction=function(i,s,e,r,n,o,a){return s&&"function"==typeof s&&"number"==typeof s(0)?(e||(e={}),e["stroke-width"]&&"number"==typeof e["stroke-width"]||(e["stroke-width"]=1.5),n||(n=t.curveLinear),this.lines||(this.lines=[]),this.lines.push({series:i,lineFunction:s,resolution:r,coords:null,xRange:o,y2:!!a,style:e,interpolate:n}),this):this},i.prototype.addLinesDataFromPoints=function(i,s,e){if(!this.points||0===this.points.length)return this.pointLines=null,this;e=e?e.toLowerCase():"average",i||(i={}),i["stroke-width"]&&"number"==typeof i["stroke-width"]||(i["stroke-width"]=1.5),i.stroke&&delete i.stroke,s||(s=t.curveLinear);for(var r={},n=0;n<this.points.length;n++){var o=this.points[n].series;o in r?(r[o].y2=this.points[n].y2,r[o].points.push(this.points[n])):r[o]={points:[this.points[n]]}}this.pointLines=[];for(var o in r){var a=r[o].points;r[o].y2?this.y2:this.y;if(!(a.length<2)){a.sort(function(t,i){return t.x-i.x});for(var h=[],n=0;n<a.length;n++){for(var l=a[n],p=!1,g=0;g<h.length;g++){if(h[g][0]===l.x){if(p=!0,"median"===e){Array.isArray(h[g][2])||(h[g][2]=[]),h[g][2].push(l.y),h[g][2].sort();var c=h[g][2].length>1?Math.round(h[g][2].length/2)-1:0;h[g][1]=h[g][2][c]}else if(h[g][2]+=1,"average"===e)h[g][1]=(h[g][1]*(h[g][2]-1)+l.y)/h[g][2];else if("lowest"===e)l.y<h[g][1]&&(h[g][1]=l.y);else{if("highest"!==e)throw"Unknown handle overlap operation: "+e;l.y>h[g][1]&&(h[g][1]=l.y)}break}if(h[g]>l.x)break}p||h.push([l.x,l.y,1])}h.length>=2&&this.pointLines.push({series:o,coords:h,y2:r[o].y2,interpolate:s,style:i})}}return this},i.prototype.addAreaBetweenTwoLines=function(i,s,e,r,n,o,a,h){return e&&"function"==typeof e&&s&&"function"==typeof s?(r||(r={}),o||(o=t.curveLinear),this.areas||(this.areas=[]),this.areas.push({series:i,areaFunctions:[s,e],coords:null,resolution:n,xRange:a,y2:!!h,style:r,interpolate:o}),this):this},i.prototype.addAreaAsCoordinates=function(i,s,e,r,n){return!s||!Array.isArray(s)||s.length<2?this:(e||(e={}),r||(r=t.curveLinear),this.areas||(this.areas=[]),this.areas.push({series:i,areaFunctions:null,coords:s,y2:!!n,style:e,interpolate:r}),this)},i.prototype.clearPointsData=function(){return this.points=null,this},i.prototype.clearLinesData=function(){return this.lines=null,this.pointLines=null,this},i.prototype.clearAreasData=function(){return this.areas=null,this},i.prototype.clearAllData=function(){return this.clearPointsData(),this.clearLinesData(),this.clearAreasData(),this},i.prototype.getPointsDataBySeries=function(t){var i=[];if(this.points)for(var s=0;s<this.points.length;s++)this.points[s].series===t&&i.push(this.points[s]);return i},i.prototype.getPointCoordinatesBySeries=function(t){var i=[];if(this.points)for(var s=0;s<this.points.length;s++)this.points[s].series===t&&i.push([this.points[s].x,this.points[s].y||0===this.points[s].y?this.points[s].y:this.points[s].y2]);return i},i.prototype.getLinesDataBySeries=function(t){var i=[];if(this.lines)for(var s=0;s<this.lines.length;s++)this.lines[s].series===t&&i.push(this.lines[s]);return i},i.prototype.getAreasDataBySeries=function(t){var i=[];if(this.areas)for(var s=0;s<this.areas.length;s++)this.areas[s].series===t&&i.push(this.areas[s]);return i},i.prototype.drawPoints=function(){if(this.removePoints(),!this.points||0===this.points.length)return this;var t,i=this,s=(this.color,this.x.scale),e=this.y.scale,r=this.y2?this.y2.scale:null;if(this.allowDrawBeyondGraph)t=this.points;else{t=[];for(var n=0;n<this.points.length;n++){var o=this.points[n].y2?this.y2:this.y,a=this.points[n].x>=this.x.min;a=a&&this.points[n].x<=this.x.max,a=a&&this.points[n].y>=o.min,a=a&&this.points[n].y<=o.max,a&&t.push(this.points[n])}}this.svgGraph.selectAll(".sg-point").data(t).enter().append("rect").attr("series",function(t){return t.series}).attr("class","sg-point").attr("width",function(t){return"function"==typeof t.pointsize?t.pointsize():t.pointsize}).attr("height",function(t){return"function"==typeof t.pointsize?t.pointsize():t.pointsize}).attr("x",function(t){var i="function"==typeof t.pointsize?t.pointsize():t.pointsize;return s(t.x)-i/2}).attr("y",function(t){var i="function"==typeof t.pointsize?t.pointsize():t.pointsize;return(t.y2?r:e)(t.y)-i/2}).attr("transform",function(t){return"rotate(45,"+s(t.x)+","+(t.y2?r:e)(t.y)+")"}).style("fill",function(t){return t.wasNull?"none":i.getColorBySeriesName(t.series,!0)}).style("stroke",function(t){return t.wasNull?i.getColorBySeriesName(t.series,!0):null});return this},i.prototype.drawLines=function(){function i(i,n,o){if(n.length<2)return this;var a=i.y2?s.y2.scale:s.y.scale,h=r.selectAll(".sg-temporary-line").data([n]).enter().append("path").attr("series",i.series).attr("class",o).style("fill","none").attr("d",t.line().x(function(t){return e(t[0])}).y(function(t){return a(t[1])}).curve(i.interpolate)),l=i.style?i.style:{};for(var p in l)h.style(p,l[p]);"stroke"in l||h.style("stroke",s.getColorBySeriesName(i.series,!0))}this.removeLines();var s=this,e=(this.color,this.x.scale),r=this.svgGraph;if(this.pointLines)for(var n=0;n<this.pointLines.length;n++){var o=this.pointLines[n];if(this.allowDrawBeyondGraph)i(o,o.coords,"sg-line");else for(var a=this._getLineSegmentsFromCoordinates(o.coords,o.y2),h=0;h<a.length;h++)i(o,a[h],"sg-line")}if(this.lines)for(var n=0;n<this.lines.length;n++){var o=this.lines[n];if(o.lineFunction)for(var a=this._getLineSegmentsFromFunction(o.lineFunction,o.resolution,o.xRange,o.y2Axis,!this.allowDrawBeyondGraph),h=0;h<a.length;h++)i(o,a[h],"sg-plotted-line");else if(this.allowDrawBeyondGraph)i(o.coords,"sg-plotted-line");else for(var a=this._getLineSegmentsFromCoordinates(o.coords,o.y2),h=0;h<a.length;h++)i(o,a[h],"sg-plotted-line")}return this},i.prototype.drawAreas=function(){function i(i,r,n){if(r.length<2||r[0].length<2||r[1].length<2)return this;var o=i.y2?s.y2.scale:s.y.scale,a=s.svgGraph.selectAll(".sg-temporary-area").data([r]).enter().append("path").attr("series",i.series).attr("class",n).attr("d",t.area().x(function(t){return e(t[0])}).y0(function(t){return o(t[1])}).y1(function(t){return o(t[2])}).curve(i.interpolate)),h=i.style?i.style:{};for(var l in h)a.style(l,h[l]);"fill"in h||a.style("fill",s.getColorBySeriesName(i.series,!0))}this.removeAreas();var s=this,e=(this.color,this.x.scale);if(this.areas)for(var r=0;r<this.areas.length;r++){var n=this.areas[r];if(n.areaFunctions)for(var o=this._getAreasPolysFromFunctions(n.areaFunctions[0],n.areaFunctions[1],n.resolution,n.xRange,n.y2,!this.allowDrawBeyondGraph),a=0;a<o.length;a++)i(n,o[a],"sg-plotted-area");else if(this.allowDrawBeyondGraph)i(n.coords,"sg-plotted-area");else for(var o=this._getAreaPolysFromCoordinates(n.coords,n.y2),a=0;a<o.length;a++)i(n,o[a],"sg-plotted-area")}return this},i.prototype._findIntercept=function(t,i,s,e){var r,n=t(i),o=t(s),a=e?this.y2:this.y;if(n<a.min!=o<a.min)r=a.min;else{if(n>a.max==o>a.max)return null;r=a.max}var h,l,p,g,c,y=i+.5*(s-i),u=.25*Math.abs(s-i),f=n,d=i;i-=1e-5,s+=1e-5;for(var x=0;x++<100;){if(h=t(y),l=Math.abs(h-r),y>=this.x.min&&y<=this.x.max&&l<1e-6)return[y,r];if(x>0&&g<l?(y=d,h=f,u*=.5):(p=h>r!=(y>d==h>f),p!==c&&(u*=.5),d=y,f=h,c=p,g=l),(y+=c?u:-u)<i||y>s)return null}return null},i.prototype._getLineSegmentsFromCoordinates=function(t,i){for(var s=i?this.y2:this.y,e=[],r=[],n=null,o=!1,a=!1,h=0;h<t.length;h++){var l=t[h];if(void 0!==l[1]&&null!==l[1]){var p=n?(t[h][1]-n[1])/(t[h][0]-n[0]):0;if(o){if(!a&&l[0]>=this.x.max&&(a=!0,l[0]>this.x.max)){if(!n)break;l=[this.x.max,n[0]+p*(l[1]-n[1])]}if(l[1]>=s.min&&l[1]<=s.max){if(0===r.length&&n&&0===p){var g=p>0?s.min:s.max,c=this.x.isDate?n[0].getTime():n[0];l=[c+(g-n[1])/p,g],this.x.isDate&&(l[0]=new Date(l[0])),h--}r.push(l)}else{if(r.length>0){var g=p>0?s.min:s.max,c=this.x.isDate?n[0].getTime():n[0];l=[c+(g-n[1])/p,g],this.x.isDate&&(l[0]=new Date(l[0])),r.push(l)}r.length>1&&(e.push(r),r=[])}if(a)break;n=l}else{if(l[0]>=this.x.min){if(o=!0,l[0]>this.x.min&&n){var y=[this.x.min,n[0]+p*(l[1]-n[1])];y[1]>=s.min&&y[1]<=s.max&&r.push(y)}l[1]>=s.min&&l[1]<=s.max&&r.push(l)}n=l}}else r.length>1&&e.push(r),r=[],n=null}return r.length>1&&e.push(r),e},i.prototype._getLineSegmentsFromFunction=function(t,i,s,e,r){var n=e?this.y2:this.y;s?(s[0]<this.x.min&&(s[0]=this.x.min),s[1]>this.x.max&&(s[0]=this.x.max)):s=[this.x.min,this.x.max],i&&"number"==typeof i||(i=Math.floor((this.width-this.margins.left-this.margins.right)/10)),i<2&&(i=2);var o;if(this.x.isLog){var a=Math.pow(s[1]/s[0],1-i);o=function(t){return t*=a,t>s[1]?s[1]:t}}else{var h=(s[1]-s[0])/(i-1),l=this.x.isDate;o=function(t){return l?new DateUTC(t.getTime()+h):t+=h}}for(var p=[],g=[],c=x=s[0];;){var y=!1;x>=s[1]&&(x=s[1],y=!0);var u=t(x);if(r){if(u>=n.min&&u<=n.max){if(0===g.length&&x>s[0]){var f=this._findIntercept(t,c,x,e);f&&g.push(f)}g.push([x,u])}else{if(g.length>0){var f=this._findIntercept(t,c,x,e);f&&g.push(f)}g.length>1&&(p.push(g),g=[])}if(c=x,x=o(x),y)break}else g.push([x,u])}return g.length>1&&p.push(g),p},i.prototype._getAreaPolysFromCoordinates=function(t,i){for(var s=[],e=[],r=0;r<t.length;r++)s.push([t[r][0],t[r][1]]),e.push([t[r][0],t[r][2]]);return this._getAreaPolysFromLineCrosswalk(this._getLineSegmentsFromCoordinates(s,i),this._getLineSegmentsFromCoordinates(e,i),i)},i.prototype._getAreasPolysFromFunctions=function(t,i,s,e,r,n){this._getLineSegmentsFromFunction(t,s,e,r,n),this._getLineSegmentsFromFunction(i,s,e,r,n);return this._getAreaPolysFromLineCrosswalk(this._getLineSegmentsFromFunction(t,s,e,r,n),this._getLineSegmentsFromFunction(i,s,e,r,n),r)},i.prototype._getAreaPolysFromLineCrosswalk=function(t,i,s){for(var e,r,n=[],o=[],a=[0,0],h=[0,0],l=[!1,!1],p=[!1,!1];;){e=l[0]?null:t[a[0]][h[0]],r=l[1]?null:i[a[1]][h[1]];var g=[!1,!1];if(!e&&!r)break;e&&r?e[0]===r[0]?(o.push([e[0],e[1],r[1]]),g[0]=g[1]=!0):(e[0]<r[0]?g[0]=!0:g[1]=!0,o.length>=2&&n.push(o),o=[]):(g=[!0,!0],o.length>=2&&n.push(o),o=[]);for(var c=[!1,!1],y=0;y<2;y++)if(!l[y]){var u=0===y?t:i;g[y]&&(h[y]+=1),p[y]=h[y]>=u[a[y]].length,p[y]&&(a[y]+=1,h[y]=0,c[y]=!0,l[y]=a[y]>=u.length)}if(c[0]&&c[1]&&(o.length>=2&&n.push(o),o=[]),l[0]&&l[1]){o.length>=2&&n.push(o);break}}return n},i.prototype.removePoints=function(){return this.svgGraph.selectAll(".sg-dot, .sg-point").remove(),this},i.prototype.removeLines=function(){return this.svgGraph.selectAll(".sg-line, .sg-plotted-line").remove(),this},i.prototype.removeAreas=function(){return this.svgGraph.selectAll(".sg-plotted-area").remove(),this},i.prototype.removeAll=function(){return this.removePoints().removeLines().removeAreas(),this},i.prototype.addTooltipToPoints=function(t,i){return this.svgGraph.selectAll(".sg-point").call(this._constructTooltipFunctionality(t,i)),this},i.prototype.addTooltipToLines=function(t,i){return this.svgGraph.selectAll(".sg-line, .sg-plotted-line").call(this._constructTooltipFunctionality(t,i)),this},i.prototype.addTooltipToAreas=function(t,i){return this.svgGraph.selectAll(".sg-plotted-area").call(this._constructTooltipFunctionality(t,i)),this},i.prototype._constructTooltipFunctionality=function(i,s){var e=this.svg;return function(r){if(!r)return null;s||(s={});var n,o=t.select("body");r.on("mouseover",function(i,e){var r=t.mouse(o.node()),a=s.offset?s.offset:[10,-15],h={};n?h={left:r[0]+a[0]+"px",top:r[1]+a[1]+"px"}:(o.selectAll(".sg-tooltip").remove(),n=o.append("div"),n.attr("class","sg-tooltip"),h={position:"absolute",left:r[0]+a[0]+"px",top:r[1]+a[1]+"px","z-index":1001,"background-color":"#fff",border:"1px solid #777","border-radius":"4px",padding:"4px 6px","font-family":"'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif","font-size":"12px"});for(var l in h)n.style(l,h[l]);if(s.style)for(var l in s.style)n.style(l,s.style[l])}).on("mousemove",function(a,h){if(n){var l=t.mouse(o.node()),p=s.offset?s.offset:[10,-15];n.style("left",l[0]+p[0]+"px"),n.style("top",l[1]+p[1]+"px");var g=i?i(a,t.mouse(e.node()),r._groups[0],h):null;g?n.html(g):(n.remove(),n=null)}}).on("mouseout",function(t,i){n&&(n.remove(),n=null)})}},i.prototype.highlightPoints=function(t,i,s,e,r){var n=".sg-point";t&&(n+="[series='"+t+"']");var o=this;return this.svgGraph.selectAll(n).each(function(t,n,a){if(!i(t))return!1;var h=o.x.scale,l=t.y2?o.y2.scale:o.y.scale;e||(e=t.wasNull?"none":o.getColorBySeriesName(t.series,!0));var p=o.svgGraph.append("rect").attr("class","sg-point-highlight").attr("width",s).attr("height",s).attr("x",h(t.x)-s/2).attr("y",l(t.y)-s/2).attr("transform","rotate(45,"+h(t.x)+","+l(t.y)+")").style("fill",e);if(r)for(var g in r)p.style(g,r[g])}),this},i.prototype.removeHighlightPoints=function(){return this.svgGraph.selectAll(".sg-point-highlight").remove(),this},i.prototype.removeHighlights=function(){return this.removeHighlightPoints(),this},i.prototype.saveAsPng=function(t){t||(t="graph.png"),t.toLowerCase().endsWith(".png")||(t+=".png");var i=this.svg.attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").node(),s=new XMLSerializer,e=s.serializeToString(i),r=document.createElement("canvas");if(r.style.display="none",r.width=this.containerWidth,r.height=this.containerHeight,navigator.msSaveBlob&&canvg)return e=e.replace('style="width: 100%; height: 1px;','style="width:'+this.containerWidth+"px; height:"+this.containerHeight+"px;"),canvg(r,e),navigator.msSaveBlob(new Blob([r.msToBlob()],{type:"image/png"}),t),this;var n=document.createElement("a");n.style.display="none",n.download=t,this.svg.node().parentNode.appendChild(n);var o=new Image;o.onload=function(){if(r.getContext("2d").drawImage(o,0,0),navigator.msSaveBlob)try{navigator.msSaveBlob(new Blob([r.msToBlob()],{type:"image/png"}),t)}catch(t){alert("Sorry, SVG to PNG downloads are restricted in Internet Explorer, please try with another browser.")}else n.href=r.toDataURL("image/png"),n.click();n.parentElement.removeChild(n),r.remove()},o.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e)))},i});