!function(t,i){String.prototype.startsWith||function(){"use strict";var t=function(){try{var t={},i=Object.defineProperty,s=i(t,t,t)&&i}catch(t){}return s}(),h={}.toString,i=function(t){if(null==this)throw TypeError();var i=String(this);if(t&&"[object RegExp]"==h.call(t))throw TypeError();var s=i.length,e=String(t),r=e.length,n=1<arguments.length?arguments[1]:void 0,a=n?Number(n):0;a!=a&&(a=0);var o=Math.min(Math.max(a,0),s);if(s<r+o)return!1;for(var l=-1;++l<r;)if(i.charCodeAt(o+l)!=e.charCodeAt(l))return!1;return!0};t?t(String.prototype,"startsWith",{value:i,configurable:!0,writable:!0}):String.prototype.startsWith=i}(),String.prototype.endsWith||function(){"use strict";var t=function(){try{var t={},i=Object.defineProperty,s=i(t,t,t)&&i}catch(t){}return s}(),h={}.toString,i=function(t){if(null==this)throw TypeError();var i=String(this);if(t&&"[object RegExp]"==h.call(t))throw TypeError();var s=i.length,e=String(t),r=e.length,n=s;if(1<arguments.length){var a=arguments[1];void 0!==a&&(n=a?Number(a):0)!=n&&(n=0)}var o=Math.min(Math.max(n,0),s)-r;if(o<0)return!1;for(var l=-1;++l<r;)if(i.charCodeAt(o+l)!=e.charCodeAt(l))return!1;return!0};t?t(String.prototype,"endsWith",{value:i,configurable:!0,writable:!0}):String.prototype.endsWith=i}(),"object"==typeof module&&module.exports?module.exports=i(require("d3")):"function"==typeof define&&define.amd?define(["d3"],i):t.SimpleGraph=i(t.d3)}(this,function(c){function t(t){for(var i in t||(t={}),t.container||(t.container="body"),t.margins||(t.margins={}),t.axis||(t.axis={}),t.styles||(t.styles={}),t.styles["font-size"]||(t.styles["font-size"]="1.0em"),this.allowDrawBeyondGraph=t.allowDrawBeyondGraph,this.margins={left:t.margins.left||0===t.margins.left?t.margins.left:40,right:t.margins.right||0===t.margins.right?t.margins.right:20,top:t.margins.top||0===t.margins.top?t.margins.top:20,bottom:t.margins.bottom||0===t.margins.bottom?t.margins.bottom:40},this.containerWidth=t.width?t.width:600,this.containerHeight=t.height?t.height:400,this.width=this.containerWidth-this.margins.left-this.margins.right,this.height=this.containerHeight-this.margins.top-this.margins.bottom,this.color=t.colorScale?t.colorScale:c.scaleOrdinal(c.schemeCategory10),this.customColors={},this.svg=c.select(t.container).append("svg").attr("width",this.containerWidth).attr("height",this.containerHeight).style("font-family","'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif").style("overflow","visible"),this.svgGraph=this.svg.append("g").attr("transform","translate("+this.margins.left+","+this.margins.top+")"),t.styles)this.svg.style(i,t.styles[i]);return this.resetAxisOptions(t.axis),this}return t.prototype.resetAxisOptions=function(t){t||(t={}),t.x||(t.x={}),t.y||(t.y={}),t.styles||(t.styles={}),this.axisStyles=t.style,this.axisStyles||(this.axisStyles={}),this.axisStyles.fill||(this.axisStyles.fill="none"),this.axisStyles["stroke-width"]||(this.axisStyles["stroke-width"]=.5),this.axisStyles.stroke||(this.axisStyles.stroke="black");for(var i=["x","y","y2"],s=0;s<i.length;s++){var e=i[s];if(!t[e]){if("y2"===e)continue;t[e]={}}t[e].scale||(t[e].scale=c.scaleLinear);var r,n,a=t[e].scale===c.scaleTime||t[e].scale===c.scaleUtc,o=!a&&t[e].scale===c.scaleLog;if(t[e].format||(t[e].format=a?"%Y-%m-%d":".0f"),t[e].grid||(t[e].grid={}),o&&!t[e].logBase&&(t[e].logBase=10),this[e]={label:null===t[e].label?"x"===e?"x-value":"y-value":t[e].label,isDate:a,isLog:o},a?t[e].scale===c.scaleUtc?this[e].format=c.utcFormat(t[e].format):this[e].format=c.timeFormat(t[e].format):this[e].format=c.format(t[e].format),this[e].min=t[e].min?t[e].min:0,this[e].max=t[e].max?t[e].max:100,this[e].scale=t[e].scale(),o&&this[e].scale.base(t[e].logBase),t[e].break){this[e].break=t[e].break,r=[this[e].min,this[e].break.domain[0],this[e].break.domain[1],this[e].max];var l=a?r.map(function(t){return t.getTime()}):r,h="x"===e?this.width:this.height;n="x"===e?[0,0,0,h]:[h,0,0,0];var p=(h-this[e].break.rangegap)/(l[1]-l[0]+l[3]-l[2]);n[1]=p*(l[1]-l[0]),n[2]=n[1]+this[e].break.rangegap}else r=[this[e].min,this[e].max],n="x"===e?[0,this.width]:[this.height,0];this[e].scale.domain(r).range(n);var g=!1;this[e].gridAxis="x"===e?(g=!0,this[e].axis=c.axisBottom(this[e].scale),this[e].axisTwo=c.axisTop(this[e].scale),c.axisBottom(this[e].scale)):"y2"===e?(this[e].axis=c.axisRight(this[e].scale),c.axisRight(this[e].scale)):(this[e].axis=c.axisLeft(this[e].scale),c.axisLeft(this[e].scale)),o?(this[e].axis.tickFormat(this[e].format),t[e].ticks?this[e].axis.ticks(t[e].ticks,this[e].format):(this[e].axis.ticks(this[e].format),t[e].tickValues&&this[e].axis.tickValues(t[e].tickValues)),g&&(this[e].axisTwo.tickFormat(this[e].format),t[e].ticks?this[e].axisTwo.ticks(t[e].ticks,this[e].format):(this[e].axisTwo.ticks(this[e].format),t[e].tickValues&&this[e].axisTwo.tickValues(t[e].tickValues)))):(this[e].axis.tickFormat(this[e].format),t[e].tickValues?(this[e].axis.tickValues(t[e].tickValues),this[e].gridAxis.tickValues(t[e].tickValues)):(t[e].ticks||0===t[e].ticks)&&(Array.isArray(t[e].ticks)?(this[e].axis.ticks(t[e].ticks[0],t[e].ticks[1]),this[e].gridAxis.ticks(t[e].ticks[0],t[e].ticks[1])):(this[e].axis.ticks(t[e].ticks),this[e].gridAxis.ticks(t[e].ticks))),this[e].gridAxis.tickFormat(this[e].format),t[e].grid.tickValues?this[e].gridAxis.tickValues(t[e].grid.tickValues):(t[e].grid.ticks||0===t[e].grid.ticks)&&(Array.isArray(t[e].grid.ticks)?this[e].gridAxis.ticks(t[e].grid.ticks[0],t[e].grid.ticks[1]):this[e].gridAxis.ticks(t[e].grid.ticks)),g&&(this[e].axisTwo.tickFormat(this[e].format),t[e].tickValues?this[e].axisTwo.tickValues(t[e].tickValues):(t[e].ticks||0===t[e].ticks)&&(Array.isArray(t[e].ticks)?this[e].axisTwo.ticks(t[e].ticks[0],t[e].ticks[1]):this[e].axisTwo.ticks(t[e].ticks))))}return this.minMax={x:[this.x.min,this.x.max],y:[this.y.min,this.y.max]},this.xScale=this.x.scale,this.xAxis=this.x.axis,this.xGridAxis=this.x.gridAxes,this.yScale=this.y.scale,this.yAxis=this.y.axis,this.yGridAxis=this.y.gridAxes,this.removeAll(),this.drawAxes(),this},t.prototype.getSvgElement=function(){return this.svg},t.prototype.getSvgGraphic=function(){return this.svgGraph},t.prototype.remove=function(){return this.svg.remove(),this},t.prototype.destroy=function(){this.svg.remove(),this.svg=null,this.svgGraph=null,this.clearAllData(),this.color=null,this.customColors=null,this.x=null,this.y=null,this.minMax=null,this.xScale=null,this.yScale=null,this.yAxis=null,this.xAxis=null,this.yGridAxis=null,this.xGridAxis=null},t.prototype.drawAxes=function(t,i,s){var e;i?"top"!==(i=i.toLowerCase().trim())&&(i="bottom"):i="bottom";var r=0;"top"!==i?(e=this.x.axis,r=this.height):e=this.x.axisTwo,s||(s=0),this.svg.selectAll(".sg-xaxis, .sg-yaxis, .sg-y2axis, .sg-axis-label").remove();var n=this.svgGraph.append("g").attr("class","sg-xaxis").attr("transform","translate(0,"+r+")").call(e).attr("font-size",null).attr("font-family",null),a=this.svgGraph.append("g").attr("class","sg-yaxis").call(this.y.axis).attr("font-size",null).attr("font-family",null),o=this.y2?this.svgGraph.append("g").attr("class","sg-y2axis").attr("transform","translate("+this.width+",0)").call(this.y2.axis).attr("font-size",null).attr("font-family",null):null;this.svgGraph.selectAll(".tick line").style("stroke","#000");var l=this.svgGraph.selectAll(".sg-xaxis .domain, .sg-yaxis .domain, .sg-y2axis .domain");for(var h in this.axisStyles)l.style(h,this.axisStyles[h]);var p={x:0,y:0,y2:0};this.svgGraph.selectAll(".sg-xaxis .tick").each(function(){this.getBBox().height>p.x&&(p.x=this.getBBox().height)}),this.svgGraph.selectAll(".sg-yaxis .tick").each(function(){this.getBBox().width>p.y&&(p.y=this.getBBox().width)}),this.svgGraph.selectAll(".sg-y2axis .tick").each(function(){this.getBBox().width>p.y2&&(p.y2=this.getBBox().width)});var g={a:"middle",x:.5*this.width,y:"top"===i?-(p.x+s):p.x+10+s},c={a:"middle",x:-.5*this.height,y:-(p.y+10+s)},y={a:"middle",x:.5*this.height,y:-(p.y2+10+s)};if(t){for(var u=t.toLowerCase().split(/[ ,]+/),f="center",d="center",x="outside",m=0;m<u.length;m++)"outside"===u[m]?(g.y="top"===i?-(p.x+s):p.x+10+s,c.y=-(p.y+10+s),y.y=-(p.y2+10+s),x="outside"):"inside"===u[m]?(g.y="top"===i?14+s:-(6+s),c.y=6+s,y.y=c.y,x="inside"):"center"===u[m]?(g.a="middle",g.x=.5*this.width,c.a="middle",c.x=-.5*this.height,y.a="middle",y.x=-c.x,d=f="center"):"left"===u[m]?(g.a="start",g.x=0,f="left"):"right"===u[m]?(g.a="end",g.x=this.width,f="right"):"top"===u[m]?(c.a="end",c.x=0,y.a="start",y.x=-c.x,d="top"):"bottom"===u[m]&&(c.a="start",c.x=-this.height,y.a="end",y.x=-c.x,d="bottom");"inside"===x&&("left"===f?g.x+=10:"right"===f&&this.y2&&(g.x-=10),"bottom"===i?"bottom"===d?(c.x+=10,y.x-=10,"left"===f?(g.x+=10,c.x+=10):"right"===f&&this.y2&&(g.x-=10,y.x-=10)):(c.x-=10,y.x+=10):"top"===d?(c.x-=10,y.x+=10,"left"===f?(g.x+=10,c.x-=10):"right"===f&&this.y2&&(g.x-=10,y.x+=10)):(c.x+=10,y.x-=10))}return n.append("text").attr("class","sg-axis-label sg-xaxis").attr("x",g.x).attr("y",g.y).attr("fill","#000").style("text-anchor",g.a).style("font-weight","bolder").text(this.x.label),a.append("text").attr("class","sg-axis-label sg-yaxis").attr("transform","rotate(-90)").attr("x",c.x).attr("y",c.y).attr("dy",".71em").attr("fill","#000").style("text-anchor",c.a).style("font-weight","bolder").text(this.y.label),o&&o.append("text").attr("class","sg-axis-label sg-y2axis").attr("transform","rotate(90)").attr("x",y.x).attr("y",y.y).attr("dy",".71em").attr("fill","#000").style("text-anchor",y.a).style("font-weight","bolder").text(this.y2.label),this},t.prototype.drawGrid=function(t){this.svgGraph.selectAll(".sg-grid").remove();var i=t&&t.opacity?parseFloat(t.opacity):.4,s=t&&t.stroke?t.stroke:"#555",e=t&&t["stroke-width"]?parseFloat(t["stroke-width"]):.3;return this.svgGraph.append("g").attr("class","sg-grid").attr("transform","translate(0,"+this.height+")").style("opacity",i).style("stroke",s).style("stroke-width",e).call(this.x.gridAxis.tickSize(-this.height).tickFormat("")),this.svgGraph.append("g").attr("class","sg-grid").attr("opacity",i).style("stroke",s).style("stroke-width",e).call(this.y.gridAxis.tickSize(-this.width).tickFormat("")),this},t.prototype.removeGrid=function(){return this.svgGraph.selectAll(".sg-grid").remove(),this},t.prototype.drawLegend=function(t,i,s,e,r,n){this.svg.selectAll(".sg-legend").remove(),t?t.x&&t.y||(t.x||0===t.x||(t.x=void 0!==t[0]&&"number"==typeof t[0]?t[0]:this.width+5),t.y||0===t.y||(t.y=void 0!==t[1]&&"number"==typeof t[1]?t[1]:0)):t={x:0,y:0},i||(i="left"),n||(n=[]),"string"==typeof n&&(n=n.trim().split(/\s+/));for(var a=0;a<n.length;a++)n[a]=n[a].toLowerCase();if(s||(s={}),s.padding){var o="string"==typeof s.padding?s.padding.split(" "):[s.padding];1===o.length?(s["padding-left"]=o[0],s["padding-right"]=o[0],s["padding-top"]=o[0],s["padding-bottom"]=o[0]):2===o.length?(s["padding-left"]=o[1],s["padding-right"]=o[1],s["padding-top"]=o[0],s["padding-bottom"]=o[0]):(3<o.length&&(s["padding-left"]=o[3]),s["padding-right"]=o[1],s["padding-top"]=o[0],s["padding-bottom"]=o[2]),delete s.padding}else s["padding-left"]||(s["padding-left"]=0),s["padding-right"]||(s["padding-right"]=0),s["padding-top"]||(s["padding-top"]=0),s["padding-bottom"]||(s["padding-bottom"]=0);s.fill||(s.fill="#fff",s.opacity=0),s["padding-left"]=parseInt(s["padding-left"]),s["padding-right"]=parseInt(s["padding-right"]),s["padding-top"]=parseInt(s["padding-top"]),s["padding-bottom"]=parseInt(s["padding-bottom"]);var p=this.svg.append("g").attr("class","sg-legend").attr("transform","translate("+t.x+","+t.y+")"),l=p.append("rect").attr("class","sg-legend-bg").attr("x",0).attr("y",0);for(var h in s)h.startsWith("padding")||l.style(h,s[h]);e||(e=0),r||(r=24);var g=0,c=s["padding-top"],y=s["padding-left"];function u(){g++,0<e&&e<=g?(0,g=0,c=s["padding-top"],y=p.node().getBBox().width+12):c+=r}var f=this;function d(t,i){if(i){var s=c+10,e=p.append("path").attr("x",y).attr("y",c).attr("d","M"+y+" "+s+" L"+(18+y)+" "+s);for(var r in f.pointLines[0].style)e.style(r,f.pointLines[0].style[r]);e.style("stroke",f.getColorBySeriesName(t.series))}var n="function"==typeof t.pointsize?t.pointsize():t.pointsize;14<n&&(n=14);var a=n/2,o=7-a,l=y+2+o,h=c+3+o;p.append("rect").attr("x",l).attr("y",h).attr("width",n).attr("height",n).attr("transform","rotate(45,"+(l+a)+","+(h+a)+")").style("fill",f.getColorBySeriesName(t.series)),p.append("text").attr("x",y+23).attr("y",c+9).attr("dy",".35em").style("text-anchor","start").text(t.series),u()}function x(t){var i=c+10,s=p.append("path").attr("x",y).attr("y",c).attr("d","M"+y+" "+i+" L"+(18+y)+" "+i);for(var e in t.style)s.style(e,t.style[e]);"stroke"in t.style||s.style("stroke",f.getColorBySeriesName(t.series)),p.append("text").attr("x",y+23).attr("y",c+9).attr("dy",".35em").style("text-anchor","start").text(t.series),u()}function m(t){var i=p.append("rect").attr("x",y).attr("y",c).attr("width",18).attr("height",18);for(var s in t.style)i.style(s,t.style[s]);"fill"in t.style||i.style("fill",f.getColorBySeriesName(t.series)),p.append("text").attr("x",y+23).attr("y",c+9).attr("dy",".35em").style("text-anchor","start").text(t.series),u()}if(this.areas&&n.indexOf("areas")<0){var v=[];for(a=0;a<this.areas.length;a++){var k=this.areas[a].series;v.indexOf(k)<0&&(v.push(k),m(this.areas[a]))}}if(this.lines&&n.indexOf("lines")<0){var w=[];for(a=0;a<this.lines.length;a++){k=this.lines[a].series;w.indexOf(k)<0&&(w.push(k),x(this.lines[a]))}}if(this.points&&n.indexOf("points")<0){var b=[];for(a=0;a<this.points.length;a++){k=this.points[a].series;if(b.indexOf(k)<0){b.push(k);var A=!1;if(this.pointLines)for(var S=this.pointLines.length;S--;)if(this.pointLines[S].series===k){A=!0;break}d(this.points[a],A)}}}var L=p.node().getBBox();return l.attr("width",L.width+s["padding-left"]+s["padding-right"]).attr("height",L.height+s["padding-top"]+s["padding-bottom"]),"middle"===(i=i.trim().toLowerCase())?t.x-=.5*L.width:"right"===i&&(t.x-=L.width),p.attr("transform","translate("+t.x+","+t.y+")"),this},t.prototype.getColorBySeriesName=function(t,i){if(!t)return null;if(t in this.customColors)return this.customColors[t];if(this.points)for(var s in this.points){var e=this.points[s];if(t===e.series)return e.style&&e.style.fill?e.style.fill:i?this.color(t):0<=this.color.domain().indexOf(t)?this.color(t):null}if(this.lines)for(var r in this.lines){var n=this.lines[r];if(t===n.series)return n.style&&n.style.stroke?n.style.stroke:i?this.color(t):0<=this.color.domain().indexOf(t)?this.color(t):null}if(this.areas)for(var a in this.areas){var o=this.areas[a];if(t===o.series)return o.style&&o.style.fill?o.style.fill:i?this.color(t):0<=this.color.domain().indexOf(t)?this.color(t):null}return i?this.color(t):void 0},t.prototype.resetColorScale=function(t){return t?this.color=t:this.color.domain([]),this},t.prototype.setSeriesColor=function(t,i){this.customColors[t]=i},t.prototype.removeSeriesColor=function(t){return this.customColors[t]&&delete this.customColors[t],this},t.prototype.addPointData=function(t,i,s,e,r,n){this.points||(this.points=[]),(!e||e<=0)&&(e=10);var a={series:t,x:parseFloat(i),y:parseFloat(s),y2:!!r,pointsize:e};if(isNaN(a.y)||!a.y&&0!==a.y){if(!n)return this;a.y=0,a.wasNull=!0}return this.points.push(a),this},t.prototype.addPointsData=function(t,i,s,e,r,n,a,o){if(!t||0===t.length)return this;this.points||(this.points=[]),(!n||n<=0)&&(n=10);for(var l=0;l<t.length;l++){var h=i?t[l][i]?t[l][i]:i:l,p=t[l][s],g=t[l][e];if(null!=p){var c={series:h,x:p,y:parseFloat(g),y2:!!a,pointsize:n};if(isNaN(c.y)||!c.y&&0!==c.y){if(!o)continue;c.y=0,c.wasNull=!0}if(isNaN(c.y)&&(c.y=0,c.wasNull=!0),r&&Array.isArray(r))for(var y=0;y<r.length;y++){for(var u=r[y],f=u,d=2;f in c;)f=u+String(d),d++;c[f]=t[l][u]}this.points.push(c)}}return this},t.prototype.addPointsDataAsArray=function(t,i,s,e,r){if(!i||0===i.length)return this;(!s||"number"!=typeof s&&"function"!=typeof s)&&(s=10),this.points||(this.points=[]);for(var n=0;n<i.length;n++)if(void 0!==i[n][0]&&null!==i[n][0]&&void 0!==i[n][1]&&null!==i[n][1]){var a={series:t,x:parseFloat(i[n][0]),y:parseFloat(i[n][1]),y2:!!e,pointsize:s};if(isNaN(a.y)||!a.y&&0!==a.y){if(!r)continue;a.y=0,a.wasNull=!0}this.points.push(a)}return this},t.prototype.addLineDataAsCoordinates=function(t,i,s,e,r){return i&&0!==i.length&&(this.lines||(this.lines=[]),s||(s={}),s["stroke-width"]&&"number"==typeof s["stroke-width"]||(s["stroke-width"]=1.5),e||(e=c.curveLinear),this.lines.push({series:t,lineFunction:null,coords:i,y2:!!r,style:s,interpolate:e})),this},t.prototype.addLineDataAsFunction=function(t,i,s,e,r,n,a){return i&&"function"==typeof i&&"number"==typeof i(0)&&(s||(s={}),s["stroke-width"]&&"number"==typeof s["stroke-width"]||(s["stroke-width"]=1.5),r||(r=c.curveLinear),this.lines||(this.lines=[]),this.lines.push({series:t,lineFunction:i,resolution:e,coords:null,xRange:n,y2:!!a,style:s,interpolate:r})),this},t.prototype.addLinesDataFromPoints=function(t,i,s){if(!this.points||0===this.points.length)return this.pointLines=null,this;s=s?s.toLowerCase():"average",t||(t={}),t["stroke-width"]&&"number"==typeof t["stroke-width"]||(t["stroke-width"]=1.5),t.stroke&&delete t.stroke,i||(i=c.curveLinear);for(var e={},r=0;r<this.points.length;r++){(n=this.points[r].series)in e?(e[n].y2=this.points[r].y2,e[n].points.push(this.points[r])):e[n]={points:[this.points[r]]}}for(var n in this.pointLines=[],e){var a=e[n].points;e[n].y2?this.y2:this.y;if(!(a.length<2)){a.sort(function(t,i){return t.x-i.x});var o=[];for(r=0;r<a.length;r++){for(var l=a[r],h=!1,p=0;p<o.length;p++){if(o[p][0]===l.x){if(h=!0,"median"===s){Array.isArray(o[p][2])||(o[p][2]=[]),o[p][2].push(l.y),o[p][2].sort();var g=1<o[p][2].length?Math.round(o[p][2].length/2)-1:0;o[p][1]=o[p][2][g]}else if(o[p][2]+=1,"average"===s)o[p][1]=(o[p][1]*(o[p][2]-1)+l.y)/o[p][2];else if("lowest"===s)l.y<o[p][1]&&(o[p][1]=l.y);else{if("highest"!==s)throw"Unknown handle overlap operation: "+s;l.y>o[p][1]&&(o[p][1]=l.y)}break}if(o[p]>l.x)break}h||o.push([l.x,l.y,1])}2<=o.length&&this.pointLines.push({series:n,lineFunction:null,resolution:null,coords:o,xRange:null,y2:e[n].y2,interpolate:i,style:t})}}return this},t.prototype.addAreaBetweenTwoLines=function(t,i,s,e,r,n,a,o){return s&&"function"==typeof s&&i&&"function"==typeof i&&(e||(e={}),n||(n=c.curveLinear),this.areas||(this.areas=[]),this.areas.push({series:t,areaFunctions:[i,s],coords:null,resolution:r,xRange:a,y2:!!o,style:e,interpolate:n})),this},t.prototype.addAreaAsCoordinates=function(t,i,s,e,r){return!i||!Array.isArray(i)||i.length<2||(s||(s={}),e||(e=c.curveLinear),this.areas||(this.areas=[]),this.areas.push({series:t,areaFunctions:null,coords:i,resolution:null,xRange:null,y2:!!r,style:s,interpolate:e})),this},t.prototype.clearPointsData=function(){return this.points=null,this},t.prototype.clearLinesData=function(){return this.lines=null,this.pointLines=null,this},t.prototype.clearAreasData=function(){return this.areas=null,this},t.prototype.clearAllData=function(){return this.clearPointsData(),this.clearLinesData(),this.clearAreasData(),this},t.prototype.getPointsDataBySeries=function(t){var i=[];if(this.points)for(var s=0;s<this.points.length;s++)this.points[s].series===t&&i.push(this.points[s]);return i},t.prototype.getPointCoordinatesBySeries=function(t){var i=[];if(this.points)for(var s=0;s<this.points.length;s++)this.points[s].series===t&&i.push([this.points[s].x,this.points[s].y||0===this.points[s].y?this.points[s].y:this.points[s].y2]);return i},t.prototype.getLinesDataBySeries=function(t){var i=[];if(this.lines)for(var s=0;s<this.lines.length;s++)this.lines[s].series===t&&i.push(this.lines[s]);return i},t.prototype.getAreasDataBySeries=function(t){var i=[];if(this.areas)for(var s=0;s<this.areas.length;s++)this.areas[s].series===t&&i.push(this.areas[s]);return i},t.prototype.drawPoints=function(){if(this.removePoints(),!this.points||0===this.points.length)return this;var t,i=this,s=(this.color,this.x.scale),e=this.y.scale,r=this.y2?this.y2.scale:null;if(this.allowDrawBeyondGraph)t=this.points;else{t=[];for(var n=0;n<this.points.length;n++){var a=this.points[n].y2?this.y2:this.y,o=this.points[n].x>=this.x.min;o=(o=(o=o&&this.points[n].x<=this.x.max)&&this.points[n].y>=a.min)&&this.points[n].y<=a.max,this.x.break&&(o=o&&(this.points[n].x<=this.x.break.domain[0]||this.points[n].x>=this.x.break.domain[0])),a.break&&(o=o&&(this.points[n].y<=a.break.domain[0]||this.points[n].y>=a.break.domain[0])),o&&t.push(this.points[n])}}this.svgGraph.selectAll(".sg-point").data(t).enter().append("rect").attr("series",function(t){return t.series}).attr("class","sg-point").attr("width",function(t){return"function"==typeof t.pointsize?t.pointsize():t.pointsize}).attr("height",function(t){return"function"==typeof t.pointsize?t.pointsize():t.pointsize}).attr("x",function(t){var i="function"==typeof t.pointsize?t.pointsize():t.pointsize;return s(t.x)-i/2}).attr("y",function(t){var i="function"==typeof t.pointsize?t.pointsize():t.pointsize;return(t.y2?r:e)(t.y)-i/2}).attr("transform",function(t){return"rotate(45,"+s(t.x)+","+(t.y2?r:e)(t.y)+")"}).style("fill",function(t){return t.wasNull?"none":i.getColorBySeriesName(t.series,!0)}).style("stroke",function(t){return t.wasNull?i.getColorBySeriesName(t.series,!0):null});return this},t.prototype.drawLines=function(){this.removeLines();var o=this,l=(this.color,this.x.scale),h=this.svgGraph;function t(t,i,s){var e=t.y2?o.y2:o.y;if(i.length<2)return this;var r=h.selectAll(".sg-temporary-line").data([i]).enter().append("path").attr("series",t.series).attr("class",s).style("fill","none").attr("d",c.line().x(function(t){return l(t[0])}).y(function(t){return e.scale(t[1])}).curve(t.interpolate)),n=t.style?t.style:{};for(var a in n)r.style(a,n[a]);"stroke"in n||r.style("stroke",o.getColorBySeriesName(t.series,!0))}if(this.pointLines)for(var i=0;i<this.pointLines.length;i++){var s=this.pointLines[i];if(this.allowDrawBeyondGraph)t(s,s.coords,"sg-line");else for(var e=this._getLineSegmentsFromCoordinates(s.coords,s.y2),r=0;r<e.length;r++)t(s,e[r],"sg-line")}if(this.lines)for(i=0;i<this.lines.length;i++){if((s=this.lines[i]).lineFunction)for(e=this._getLineSegmentsFromFunction(s.lineFunction,s.resolution,s.xRange,s.y2Axis,!this.allowDrawBeyondGraph),r=0;r<e.length;r++)t(s,e[r],"sg-plotted-line");else if(this.allowDrawBeyondGraph)t(s.coords,"sg-plotted-line");else for(e=this._getLineSegmentsFromCoordinates(s.coords,s.y2),r=0;r<e.length;r++)t(s,e[r],"sg-plotted-line")}return this},t.prototype.drawAreas=function(){this.removeAreas();var o=this,l=(this.color,this.x.scale);function t(t,i,s){if(i.length<2||i[0].length<2||i[1].length<2)return this;var e=t.y2?o.y2.scale:o.y.scale,r=o.svgGraph.selectAll(".sg-temporary-area").data([i]).enter().append("path").attr("series",t.series).attr("class",s).attr("d",c.area().x(function(t){return l(t[0])}).y0(function(t){return e(t[1])}).y1(function(t){return e(t[2])}).curve(t.interpolate)),n=t.style?t.style:{};for(var a in n)r.style(a,n[a]);"fill"in n||r.style("fill",o.getColorBySeriesName(t.series,!0))}if(this.areas)for(var i=0;i<this.areas.length;i++){var s=this.areas[i];if(s.areaFunctions)for(var e=this._getAreasPolysFromFunctions(s.areaFunctions[0],s.areaFunctions[1],s.resolution,s.xRange,s.y2,!this.allowDrawBeyondGraph),r=0;r<e.length;r++)t(s,e[r],"sg-plotted-area");else if(this.allowDrawBeyondGraph)t(s.coords,"sg-plotted-area");else for(e=this._getAreaPolysFromCoordinates(s.coords,s.y2),r=0;r<e.length;r++)t(s,e[r],"sg-plotted-area")}return this},t.prototype._findIntercept=function(t,i,s,e){var r,n=t(i),a=t(s),o=e?this.y2:this.y;if(n<o.min!=a<o.min)r=o.min;else{if(n>o.max==a>o.max)return null;r=o.max}var l,h,p,g,c,y=i+.5*(s-i),u=.25*Math.abs(s-i),f=n,d=i;i-=1e-5,s+=1e-5;for(var x=0;x++<100;){if(l=t(y),h=Math.abs(l-r),y>=this.x.min&&y<=this.x.max&&h<1e-6)return[y,r];if(0<x&&g<h?(y=d,l=f,u*=.5):((p=r<l!=(d<y==f<l))!==c&&(u*=.5),d=y,f=l,c=p,g=h),(y+=c?u:-u)<i||s<y)return null}return null},t.prototype._getLineSegmentsFromCoordinates=function(t,i){for(var s=i?this.y2:this.y,e=[],r=[],n=null,a=!1,o=!1,l=0;l<t.length;l++){var h=t[l];if(void 0!==h[1]&&null!==h[1]){var p=n?(t[l][1]-n[1])/(t[l][0]-n[0]):0;if(a){if(!o&&h[0]>=this.x.max&&(o=!0,h[0]>this.x.max)){if(!n)break;h=[this.x.max,n[0]+p*(h[1]-n[1])]}if(h[1]>=s.min&&h[1]<=s.max){if(0===r.length&&n&&0!==p){var g=0<p?s.min:s.max;h=[(this.x.isDate?n[0].getTime():n[0])+(g-n[1])/p,g],this.x.isDate&&(h[0]=new Date(h[0])),l--}r.push(h)}else{if(0<r.length){g=0<p?s.max:s.min;h=[(this.x.isDate?n[0].getTime():n[0])+(g-n[1])/p,g],this.x.isDate&&(h[0]=new Date(h[0])),r.push(h)}1<r.length&&(e.push(r),r=[])}if(o)break;n=h}else{if(h[0]>=this.x.min){if(a=!0,h[0]>this.x.min&&n){var c=[this.x.min,n[0]+p*(h[1]-n[1])];c[1]>=s.min&&c[1]<=s.max&&r.push(c)}h[1]>=s.min&&h[1]<=s.max&&r.push(h)}n=h}}else 1<r.length&&e.push(r),r=[],n=null}return 1<r.length&&e.push(r),e},t.prototype._getLineSegmentsFromFunction=function(t,i,s,e,r){var n,a=e?this.y2:this.y;if(s?(s[0]<this.x.min&&(s[0]=this.x.min),s[1]>this.x.max&&(s[0]=this.x.max)):s=[this.x.min,this.x.max],i&&"number"==typeof i||(i=Math.floor((this.width-this.margins.left-this.margins.right)/10)),i<2&&(i=2),this.x.isLog){var o=Math.pow(s[1]/s[0],1-i);n=function(t){return(t*=o)>s[1]?s[1]:t}}else{var l=(s[1]-s[0])/(i-1),h=this.x.isDate;n=function(t){return h?new DateUTC(t.getTime()+l):t+l}}for(var p=[],g=[],c=x=s[0];;){var y=!1;(x>=s[1]||isNaN(x))&&(x=s[1],y=!0);var u=t(x);if(r){if(u>=a.min&&u<=a.max){if(0===g.length&&x>s[0])(f=this._findIntercept(t,c,x,e))&&g.push(f);g.push([x,u])}else{var f;if(0<g.length)(f=this._findIntercept(t,c,x,e))&&g.push(f);1<g.length&&(p.push(g),g=[])}if(c=x,x=n(x),y)break}else g.push([x,u])}return 1<g.length&&p.push(g),p},t.prototype._getAreaPolysFromCoordinates=function(t,i){for(var s=[],e=[],r=0;r<t.length;r++)s.push([t[r][0],t[r][1]]),e.push([t[r][0],t[r][2]]);return this._getAreaPolysFromLineCrosswalk(this._getLineSegmentsFromCoordinates(s,i),this._getLineSegmentsFromCoordinates(e,i),i)},t.prototype._getAreasPolysFromFunctions=function(t,i,s,e,r,n){this._getLineSegmentsFromFunction(t,s,e,r,n),this._getLineSegmentsFromFunction(i,s,e,r,n);return this._getAreaPolysFromLineCrosswalk(this._getLineSegmentsFromFunction(t,s,e,r,n),this._getLineSegmentsFromFunction(i,s,e,r,n),r)},t.prototype._getAreaPolysFromLineCrosswalk=function(t,i,s){for(var e,r,n=[],a=[],o=[0,0],l=[0,0],h=[!1,!1],p=[!1,!1];;){e=h[0]?null:t[o[0]][l[0]],r=h[1]?null:i[o[1]][l[1]];var g=[!1,!1];if(!e&&!r)break;e&&r?e[0]===r[0]?(a.push([e[0],e[1],r[1]]),g[0]=g[1]=!0):(e[0]<r[0]?g[0]=!0:g[1]=!0,2<=a.length&&n.push(a),a=[]):(g=[!0,!0],2<=a.length&&n.push(a),a=[]);for(var c=[!1,!1],y=0;y<2;y++)if(!h[y]){var u=0===y?t:i;g[y]&&(l[y]+=1),p[y]=l[y]>=u[o[y]].length,p[y]&&(o[y]+=1,l[y]=0,c[y]=!0,h[y]=o[y]>=u.length)}if(c[0]&&c[1]&&(2<=a.length&&n.push(a),a=[]),h[0]&&h[1]){2<=a.length&&n.push(a);break}}return n},t.prototype.removePoints=function(){return this.svgGraph.selectAll(".sg-dot, .sg-point").remove(),this},t.prototype.removeLines=function(){return this.svgGraph.selectAll(".sg-line, .sg-plotted-line").remove(),this},t.prototype.removeAreas=function(){return this.svgGraph.selectAll(".sg-plotted-area").remove(),this},t.prototype.removeAll=function(){return this.removePoints().removeLines().removeAreas(),this},t.prototype.addTooltipToPoints=function(t,i){return this.svgGraph.selectAll(".sg-point").call(this._constructTooltipFunctionality(t,i)),this},t.prototype.addTooltipToLines=function(t,i){return this.svgGraph.selectAll(".sg-line, .sg-plotted-line").call(this._constructTooltipFunctionality(t,i)),this},t.prototype.addTooltipToAreas=function(t,i){return this.svgGraph.selectAll(".sg-plotted-area").call(this._constructTooltipFunctionality(t,i)),this},t.prototype._constructTooltipFunctionality=function(l,h){var p=this.svg;return function(n){if(!n)return null;h||(h={});var a,o=c.select("body");n.on("mouseover",function(t,i){var s=c.mouse(o.node()),e=h.offset?h.offset:[10,-15],r={};for(var n in r=a?{left:s[0]+e[0]+"px",top:s[1]+e[1]+"px"}:(o.selectAll(".sg-tooltip").remove(),(a=o.append("div")).attr("class","sg-tooltip"),{position:"absolute",left:s[0]+e[0]+"px",top:s[1]+e[1]+"px","z-index":1001,"background-color":"#fff",border:"1px solid #777","border-radius":"4px",padding:"4px 6px","font-family":"'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif","font-size":"12px"}))a.style(n,r[n]);if(h.style)for(var n in h.style)a.style(n,h.style[n])}).on("mousemove",function(t,i){if(a){var s=c.mouse(o.node()),e=h.offset?h.offset:[10,-15];a.style("left",s[0]+e[0]+"px"),a.style("top",s[1]+e[1]+"px");var r=l?l(t,c.mouse(p.node()),n._groups[0],i):null;r?a.html(r):(a.remove(),a=null)}}).on("mouseout",function(t,i){a&&(a.remove(),a=null)})}},t.prototype.highlightPoints=function(t,l,h,p,g){var i=".sg-point";t&&(i+="[series='"+t+"']");var c=this;return this.svgGraph.selectAll(i).each(function(t,i,s){if(!l||l(t)){var e=c.x.scale,r=t.y2?c.y2.scale:c.y.scale;p||(p=t.wasNull?"none":c.getColorBySeriesName(t.series,!0));var n=h||t.pointsize;"function"==typeof n&&(n=n.call(t));var a=c.svgGraph.append("rect").attr("class","sg-point-highlight").attr("width",n).attr("height",n).attr("x",e(t.x)-n/2).attr("y",r(t.y)-n/2).attr("transform","rotate(45,"+e(t.x)+","+r(t.y)+")").style("fill",p);if(g)for(var o in g)a.style(o,g[o])}}),this},t.prototype.removeHighlightPoints=function(){return this.svgGraph.selectAll(".sg-point-highlight").remove(),this},t.prototype.removeHighlights=function(){return this.removeHighlightPoints(),this},t.prototype.saveAsPng=function(t){t||(t="graph.png"),t.toLowerCase().endsWith(".png")||(t+=".png");var i=this.svg.attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").node(),s=(new XMLSerializer).serializeToString(i),e=document.createElement("canvas");if(e.style.display="none",e.width=this.containerWidth,e.height=this.containerHeight,navigator.msSaveBlob&&canvg)return s=s.replace('style="width: 100%; height: 1px;','style="width:'+this.containerWidth+"px; height:"+this.containerHeight+"px;"),canvg(e,s),navigator.msSaveBlob(new Blob([e.msToBlob()],{type:"image/png"}),t),this;var r=document.createElement("a");r.style.display="none",r.download=t,this.svg.node().parentNode.appendChild(r);var n=new Image;n.onload=function(){if(e.getContext("2d").drawImage(n,0,0),navigator.msSaveBlob)try{navigator.msSaveBlob(new Blob([e.msToBlob()],{type:"image/png"}),t)}catch(t){alert("Sorry, SVG to PNG downloads are restricted in Internet Explorer, please try with another browser.")}else r.href=e.toDataURL("image/png"),r.click();r.parentElement.removeChild(r),e.remove()},n.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(s)))},t});